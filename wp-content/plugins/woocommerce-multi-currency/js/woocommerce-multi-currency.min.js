jQuery(document).ready(function(c){"use strict";c(document.body).on("updated_checkout",function(e,t){t.hasOwnProperty("wmc_update_checkout")&&t.wmc_update_checkout&&c(document.body).trigger("update_checkout")}),c(document.body).on("payment_method_selected",function(e,t){"ppcp-gateway"===c('.woocommerce-checkout input[name="payment_method"]:checked').val()&&c(document.body).trigger("update_checkout")}),window.woocommerce_multi_currency={init:function(){this.design(),this.checkPosition(),this.click_to_expand(),"1"===wooMultiCurrencyParams.enableCacheCompatible&&(this.cacheCompatible(),this.ajaxComplete())},disableCurrentCurrencyLink(){c(".wmc-active a").on("click",function(c){c.preventDefault(),c.stopImmediatePropagation()})},design:function(){jQuery(window).width()<=768?jQuery(".woocommerce-multi-currency.wmc-sidebar").on("click",function(){jQuery(this).toggleClass("wmc-hover"),jQuery(this).hasClass("wmc-hover")?jQuery("html").css({overflow:"hidden"}):jQuery("html").css({overflow:"visible"})}):(jQuery(".woocommerce-multi-currency.wmc-sidebar").on("mouseenter",function(){jQuery(this).addClass("wmc-hover")}),jQuery(".woocommerce-multi-currency.wmc-sidebar").on("mouseleave",function(){jQuery(this).removeClass("wmc-hover")}))},checkPosition:function(){jQuery(".woocommerce-multi-currency .wmc-currency-wrapper").on("mouseenter",function(){let e=c(this).closest(".woocommerce-multi-currency");e.hasClass("wmc-currency-trigger-click")||(this.getBoundingClientRect().top/c(window).height()>.5?e.find(".wmc-sub-currency").addClass("wmc-show-up"):e.find(".wmc-sub-currency").removeClass("wmc-show-up"))})},click_to_expand(){c(document.body).on("click",function(e){c(".wmc-currency-trigger-click-active").removeClass("wmc-currency-trigger-click-active")}),c(document.body).on("click",".wmc-currency-trigger-click",function(e){let t=c(this);e.stopPropagation(),t.toggleClass("wmc-currency-trigger-click-active"),this.getBoundingClientRect().top/c(window).height()>.5?t.find(".wmc-sub-currency").addClass("wmc-show-up"):t.find(".wmc-sub-currency").removeClass("wmc-show-up")})},cacheCompatible(){if("undefined"!=typeof wc_checkout_params&&1===parseInt(wc_checkout_params.is_checkout))return;let e=[],t=c(".wmc-cache-pid");t.length&&t.each(function(t,r){let a=c(r).data("wmc_product_id");a&&e.push(a)});let r=c(".variations_form");r.length&&r.each(function(t,r){let a=c(r).data("product_variations");a.length&&a.forEach(c=>{e.push(c.variation_id)})});let a=c(".woocommerce-multi-currency.wmc-shortcode").not(".wmc-list-currency-rates"),o=[];a.map(function(){let e=c(this);o.push({layout:e.data("layout"),flag_size:e.data("flag_size"),dropdown_icon:e.data("dropdown_icon"),custom_format:e.data("custom_format")})}),e.length&&(e=[...new Set(e)]);let i=[];c(".wmc-cache-value").each(function(e,t){i.push({price:c(t).data("price"),original_price:c(t).data("original_price"),currency:c(t).data("currency"),product_id:c(t).data("product_id"),keep_format:c(t).data("keep_format")})}),i=[...new Set(i.map(JSON.stringify))].map(JSON.parse),c.ajax({url:wooMultiCurrencyParams.ajaxUrl,type:"POST",data:{action:"wmc_get_products_price",pids:e,shortcodes:o,wmc_current_url:c(".wmc-current-url").val(),exchange:i},success(e){if(e.success){let t=e.data.prices||"",r=e.data.current_currency||"",i=e.data.exchange||"";if(o.length>0&&o.length===e.data.shortcodes.length)for(let c=0;c<o.length;c++)a.eq(c).replaceWith(e.data.shortcodes[c]);if("1"!==wooMultiCurrencyParams.switchByJS&&c(".wmc-currency a").unbind(),r&&(c(".wmc-sidebar .wmc-currency").removeClass("wmc-active"),c(`.wmc-sidebar .wmc-currency[data-currency=${r}]`).addClass("wmc-active"),c(".wmc-price-switcher .wmc-current-currency i").removeClass().addClass("vi-flag-64 flag-"+e.data.current_country),c(".wmc-price-switcher .wmc-hidden").removeClass("wmc-hidden"),c(`.wmc-price-switcher .wmc-currency[data-currency=${r}]`).addClass("wmc-hidden"),c(`select.wmc-nav option[data-currency=${r}]`).prop("selected",!0)),t){for(let e in t)c(`.wmc-cache-pid[data-wmc_product_id=${e}]`).replaceWith(t[e]);c(".variations_form").each((e,r)=>{let a=c(r).data("product_variations");a&&(a.map(c=>{let e=c.variation_id;return c.price_html=t[e],c}),c(r).data("product_variations",a))})}if(i)for(let e in i)c(`.wmc-cache-value[data-price="${i[e].price}"][data-product_id="${i[e].product_id}"][data-keep_format="${i[e].keep_format}"][data-original_price="${i[e].original_price}"][data-currency="${i[e].currency}"]`).replaceWith(i[e].shortcode);jQuery(document.body).trigger("wmc_cache_compatible_finish",[e.data])}}})},ajaxComplete(){c(document).on("append.infiniteScroll",()=>{this.cacheCompatible()})}},woocommerce_multi_currency.init()});